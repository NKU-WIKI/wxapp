<!-- 帖子详情页 -->
<view class="container">
  <!-- 编辑模式 -->
  <post-edit 
    wx:if="{{isEditMode}}"
    post="{{postDetail}}"
    bind:submit="onPostEdit"
  />

  <!-- 展示模式 -->
  <block wx:else>
    <!-- 加载状态 -->
    <loading wx:if="{{loading}}" />

    <!-- 错误状态 -->
    <empty 
      wx:elif="{{error}}"
      type="error"
      text="{{errorText}}"
      btnText="重试"
      bind:btnTap="loadInitialData"
    />

    <!-- 帖子内容 -->
    <block wx:else>
      <!-- 帖子详情 -->
      <post-item
        post="{{postDetail}}"
        currentOpenid="{{userInfo.openid || ''}}"
        bind:usertap="onUserTap"
        bind:like="handleLike"
        bind:favorite="handleFavorite"
      />

      <!-- 评论列表 -->
      <comment-list
        comments="{{comments}}"
        total="{{postDetail.comment_count}}"
        loading="{{loadingComment}}"
        error="{{commentError}}"
        hasMore="{{hasMore}}"
        currentOpenid="{{userInfo.openid || ''}}"
      />
    </block>
  </block>
</view>

<!-- WEUI组件 -->
<mp-toptips msg="{{toptipsMsg}}" type="{{toptipsType}}" show="{{toptipsShow}}"></mp-toptips>
<mp-dialog title="{{dialogTitle}}" show="{{dialogShow}}" buttons="{{dialogButtons}}"></mp-dialog>
<mp-actionsheet bindactiontap="actionSheetClick" show="{{actionSheetShow}}" actions="{{actionSheetGroups}}"></mp-actionsheet> 